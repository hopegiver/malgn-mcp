{
  "type": "jsp-restapi",
  "title": "REST API (JSP)",
  "variables": {
    "TABLE_NAME": { "description": "테이블명", "example": "tb_board" },
    "DAO_CLASS": { "description": "DAO 클래스명", "example": "BoardDao" },
    "DAO_VAR": { "description": "DAO 변수명", "example": "board" },
    "API_BASE": { "description": "API 베이스 경로", "example": "/api/board" }
  },
  "jsp_template": "<%@ include file=\"/api/init.jsp\" %><%\n\napi.setBasePath(\"{API_BASE}\");\n\n// GET {API_BASE}/list - 목록 조회\napi.get(\"/list\", () -> {\n    String keyword = m.rs(\"keyword\");\n    int page = m.ri(\"page\");\n    int pageSize = m.ri(\"page_size\");\n    if(page == 0) page = 1;\n    if(pageSize == 0) pageSize = 10;\n\n    {DAO_CLASS} {DAO_VAR} = new {DAO_CLASS}();\n    ListManager lm = new ListManager();\n    lm.setRequest(request);\n    lm.setDao({DAO_VAR});\n    lm.setPageRow(pageSize);\n    lm.setTable(\"{TABLE_NAME}\");\n    lm.setFields(\"*\");\n    lm.addSearch(\"title,content\", keyword, \"LIKE\");\n    lm.setOrderBy(\"id DESC\");\n\n    DataSet list = lm.getDataSet();\n\n    api.put(\"items\", list);\n    api.put(\"total\", lm.getTotalNum());\n    api.success(\"목록 조회 성공\");\n});\n\n// GET {API_BASE}/view/:id - 상세 조회\napi.get(\"/view/:id\", () -> {\n    int id = api.paramInt(\"id\");\n    if(id == 0) { api.error(\"INVALID_PARAMETER\", \"ID가 필요합니다.\"); return; }\n\n    {DAO_CLASS} {DAO_VAR} = new {DAO_CLASS}();\n    DataSet info = {DAO_VAR}.get(id);\n    if(!info.next()) { api.error(\"NOT_FOUND\", \"데이터를 찾을 수 없습니다.\"); return; }\n\n    api.put(\"{DAO_VAR}\", info);\n    api.success(\"조회 성공\");\n});\n\n// POST {API_BASE}/write - 등록\napi.post(\"/write\", () -> {\n    if(!isLogin) { api.error(\"UNAUTHORIZED\", \"로그인이 필요합니다.\"); return; }\n\n    f.addElement(\"title\", \"required\", \"제목을 입력하세요.\");\n    f.addElement(\"content\", \"required\", \"내용을 입력하세요.\");\n    if(!f.validate()) { api.error(\"VALIDATION_FAILED\", f.getErrorMessage()); return; }\n\n    {DAO_CLASS} {DAO_VAR} = new {DAO_CLASS}();\n    {DAO_VAR}.item(\"user_id\", userId);\n    {DAO_VAR}.item(\"title\", f.get(\"title\"));\n    {DAO_VAR}.item(\"content\", f.get(\"content\"));\n    {DAO_VAR}.item(\"reg_date\", m.time(\"yyyyMMddHHmmss\"));\n    {DAO_VAR}.item(\"status\", 1);\n\n    if({DAO_VAR}.insert()) {\n        api.put(\"{DAO_VAR}_id\", {DAO_VAR}.id);\n        api.success(\"등록되었습니다.\");\n    } else {\n        api.error(\"INSERT_FAILED\", \"등록에 실패했습니다.\");\n    }\n});\n\n// PUT {API_BASE}/update/:id - 수정\napi.put(\"/update/:id\", () -> {\n    if(!isLogin) { api.error(\"UNAUTHORIZED\", \"로그인이 필요합니다.\"); return; }\n\n    int id = api.paramInt(\"id\");\n    if(id == 0) { api.error(\"INVALID_PARAMETER\", \"ID가 필요합니다.\"); return; }\n\n    {DAO_CLASS} {DAO_VAR} = new {DAO_CLASS}();\n    DataSet info = {DAO_VAR}.get(id);\n    if(!info.next()) { api.error(\"NOT_FOUND\", \"데이터를 찾을 수 없습니다.\"); return; }\n    if(info.i(\"user_id\") != userId) { api.error(\"FORBIDDEN\", \"수정 권한이 없습니다.\"); return; }\n\n    f.addElement(\"title\", \"required\", \"제목을 입력하세요.\");\n    f.addElement(\"content\", \"required\", \"내용을 입력하세요.\");\n    if(!f.validate()) { api.error(\"VALIDATION_FAILED\", f.getErrorMessage()); return; }\n\n    {DAO_VAR}.item(\"title\", f.get(\"title\"));\n    {DAO_VAR}.item(\"content\", f.get(\"content\"));\n    {DAO_VAR}.item(\"mod_date\", m.time(\"yyyyMMddHHmmss\"));\n\n    if({DAO_VAR}.update(\"id = ?\", new Object[]{id})) {\n        api.success(\"수정되었습니다.\");\n    } else {\n        api.error(\"UPDATE_FAILED\", \"수정에 실패했습니다.\");\n    }\n});\n\n// DELETE {API_BASE}/delete/:id - 삭제\napi.delete(\"/delete/:id\", () -> {\n    if(!isLogin) { api.error(\"UNAUTHORIZED\", \"로그인이 필요합니다.\"); return; }\n\n    int id = api.paramInt(\"id\");\n    if(id == 0) { api.error(\"INVALID_PARAMETER\", \"ID가 필요합니다.\"); return; }\n\n    {DAO_CLASS} {DAO_VAR} = new {DAO_CLASS}();\n    DataSet info = {DAO_VAR}.get(id);\n    if(!info.next()) { api.error(\"NOT_FOUND\", \"데이터를 찾을 수 없습니다.\"); return; }\n    if(info.i(\"user_id\") != userId) { api.error(\"FORBIDDEN\", \"삭제 권한이 없습니다.\"); return; }\n\n    if({DAO_VAR}.delete(\"id = ?\", new Object[]{id})) {\n        api.success(\"삭제되었습니다.\");\n    } else {\n        api.error(\"DELETE_FAILED\", \"삭제에 실패했습니다.\");\n    }\n});\n\n%>",
  "notes": [
    "API 전용 init.jsp 사용: <%@ include file=\"/api/init.jsp\" %>",
    "api/init.jsp에서 CORS, JWT 인증, publicRoute 설정이 처리됨",
    "api.success()/api.error()로 응답 (j.success 아님)",
    "api.error(\"ERROR_CODE\", \"메시지\") 형식으로 에러 코드 전달",
    "api.paramInt(\"id\")로 경로 파라미터 조회, f.get()으로 폼 데이터 조회",
    "update/delete에 바인딩 파라미터 사용 (WHERE 접두사 없음)"
  ]
}
