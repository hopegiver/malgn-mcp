{
  "slug": "i18n",
  "title": "다국어 지원 (Internationalization)",
  "category": "util",
  "content": "# 다국어 지원 (Internationalization)\n\n맑은프레임워크의 Message 클래스는 다국어 웹 애플리케이션을 구축하기 위한 국제화(i18n) 기능을 제공합니다.\n\n## 목차\n\n- [기본 개념](#기본-개념)\n- [메시지 파일 구조](#메시지-파일-구조)\n- [Message 클래스 사용](#message-클래스-사용)\n- [동적 메시지](#동적-메시지)\n- [캐시 및 성능](#캐시-및-성능)\n\n---\n\n## 기본 개념\n\n### 다국어 처리 방식\n\nMessage 클래스는 properties 파일 기반의 다국어 메시지 시스템을 제공합니다:\n\n- **메시지 파일**: 키-값 쌍으로 메시지 저장\n- **로케일 지원**: 언어별 메시지 파일 관리\n- **폴백 처리**: 해당 언어에 메시지가 없으면 기본 언어로 대체\n- **메모리 캐싱**: 성능을 위한 자동 캐싱\n\n---\n\n## 메시지 파일 구조\n\n### 파일 위치\n\n기본 경로: `/WEB-INF/message/`\n\n설정 변경:\n```jsp\nConfig.set(\"msgDir\", \"/custom/message/path\");\n```\n\n### 파일 명명 규칙\n\n```\n/WEB-INF/message/\n  ├── message.properties          (기본 언어)\n  ├── message_en.properties       (영어)\n  ├── message_ko.properties       (한국어)\n  ├── message_ja.properties       (일본어)\n  └── message_zh.properties       (중국어)\n```\n\n### 메시지 파일 형식\n\n**message.properties** (기본 - 한국어)\n```properties\n# 사용자 인터페이스\nwelcome=환영합니다\nlogin=로그인\nlogout=로그아웃\nname=이름\nemail=이메일\npassword=비밀번호\n\n# 에러 메시지\nerror.required=필수 항목입니다\nerror.invalid_email=올바른 이메일 주소를 입력하세요\nerror.password_mismatch=비밀번호가 일치하지 않습니다\n\n# 시스템 메시지\nsysop.book_insert.specify_books=도서를 선택해주세요\nmain.log=사용자 {0}이(가) {1}에 로그인했습니다\n```\n\n**message_en.properties** (영어)\n```properties\nwelcome=Welcome\nlogin=Login\nlogout=Logout\nname=Name\nemail=Email\npassword=Password\n\nerror.required=This field is required\nerror.invalid_email=Please enter a valid email address\nerror.password_mismatch=Passwords do not match\n\nsysop.book_insert.specify_books=Please select books\nmain.log=User {0} logged in at {1}\n```\n\n---\n\n## Message 클래스 사용\n\n### 기본 사용법\n\n```jsp\n<%@ page contentType=\"text/html; charset=utf-8\" %><%@ include file=\"/init.jsp\" %><%\n\n// 기본 로케일로 Message 객체 생성\nMessage msg = new Message();\n\n// 메시지 가져오기\nString welcome = msg.get(\"welcome\");      // \"환영합니다\"\nString login = msg.get(\"login\");          // \"로그인\"\n\nm.p(welcome);\nm.p(login);\n\n%>\n```\n\n### 로케일 지정\n\n```jsp\n// 영어로 설정\nMessage msg = new Message(\"en\");\nm.p(msg.get(\"welcome\"));  // \"Welcome\"\n\n// 또는 setLocale 사용\nMessage msg = new Message();\nmsg.setLocale(\"en\");\nm.p(msg.get(\"welcome\"));  // \"Welcome\"\n\nmsg.setLocale(\"ko\");\nm.p(msg.get(\"welcome\"));  // \"환영합니다\"\n```\n\n### 기본값 처리\n\n```jsp\nMessage msg = new Message();\n\n// 메시지가 없으면 키를 반환\nString unknown = msg.get(\"unknown.key\");  // \"unknown.key\"\n\n// 사용자 정의 기본값\nString custom = msg.get(\"unknown.key\", \"기본 메시지\");  // \"기본 메시지\"\n```\n\n---\n\n## 동적 메시지\n\n### 매개변수가 있는 메시지\n\n**message.properties**\n```properties\nuser.greeting=안녕하세요, {0}님!\norder.confirm=주문 {0}개 상품이 {1}원에 결제되었습니다\n```\n\n**JSP 코드**\n```jsp\nMessage msg = new Message();\n\n// MessageFormat 스타일 ({0}, {1}, ...)\nString greeting = msg.format(\"user.greeting\", \"홍길동\");\n// \"안녕하세요, 홍길동님!\"\n\nString confirm = msg.format(\"order.confirm\", 3, 50000);\n// \"주문 3개 상품이 50000원에 결제되었습니다\"\n```\n\n### 플레이스홀더 치환\n\n**message.properties**\n```properties\nemail.template=안녕하세요 {{name}}님, {{product}} 주문이 완료되었습니다.\n```\n\n**JSP 코드**\n```jsp\nMessage msg = new Message();\n\nString[] params = {\n    \"name=>홍길동\",\n    \"product=>맥북 프로\"\n};\n\nString email = msg.get(\"email.template\", params);\n// \"안녕하세요 홍길동님, 맥북 프로 주문이 완료되었습니다.\"\n```\n\n---\n\n## 배열과 Map 처리\n\n### 배열 메시지\n\n```jsp\nMessage msg = new Message();\n\nString[] keys = {\n    \"status.0=>pending\",\n    \"status.1=>approved\",\n    \"status.2=>rejected\"\n};\n\nString[] messages = msg.getArray(keys);\n```\n\n### Map 메시지\n\n```jsp\nMap<String, String> map = new HashMap<>();\nmap.put(\"title\", \"welcome\");\nmap.put(\"subtitle\", \"login\");\n\nMap<String, String> translated = msg.getMap(map);\n```\n\n---\n\n## 캐시 및 성능\n\n### 메모리 캐싱\n\nMessage 클래스는 메시지 파일을 메모리에 캐싱하여 성능을 최적화합니다.\n\n```jsp\nMessage msg = new Message();\n\n// 첫 번째 호출: 파일에서 로드 및 캐싱\nString text1 = msg.get(\"welcome\");\n\n// 두 번째 호출: 캐시에서 가져옴 (빠름)\nString text2 = msg.get(\"login\");\n```\n\n### 캐시 새로고침\n\n메시지 파일을 수정한 후 변경사항을 반영하려면:\n\n```jsp\nMessage msg = new Message();\n\n// 특정 로케일 캐시 재로드\nmsg.reload(\"en\");\n\n// 기본 로케일 캐시 재로드\nmsg.reload();\n\n// 모든 로케일 캐시 재로드\nmsg.reloadAll();\n```\n\n---\n\n## 실제 사용 예제\n\n### 다국어 웹페이지\n\n```jsp\n<%@ page contentType=\"text/html; charset=utf-8\" %><%@ include file=\"/init.jsp\" %><%\n\n// 사용자 언어 설정 가져오기\nString lang = m.cookie(\"lang\");\nif(lang == null || lang.isEmpty()) lang = \"default\";\n\nMessage msg = new Message(lang);\n\np.setBody(\"user.profile\");\np.setVar(\"msg\", msg);\np.display();\n\n%>\n```\n\n### 폼 검증 메시지\n\n```jsp\nMessage msg = new Message();\n\nf.addElement(\"email\", null, \"required:Y, email:Y\");\nf.addElement(\"password\", null, \"required:Y, minlength:8\");\n\nif(m.isPost() && !f.validate()) {\n    String emailError = msg.format(\"validation.email\");\n    String passwordError = msg.format(\"validation.minlength\", \"비밀번호\", 8);\n\n    m.jsError(f.getErrorString());\n    return;\n}\n```\n\n### 동적 알림 메시지\n\n```jsp\nMessage msg = new Message();\n\nString notification1 = msg.format(\"notification.new_message\", \"홍길동\");\nString notification2 = msg.format(\"notification.order_shipped\", \"A123456\", \"1234-5678-9012\");\nString notification3 = msg.format(\"notification.password_changed\", Malgn.time(\"yyyy-MM-dd HH:mm\"));\n```\n\n---\n\n## 언어 전환 구현\n\n### 언어 선택 UI\n\n쿠키 기반의 언어 설정과 컴포넌트 방식의 언어 선택 UI를 제공합니다.\n\n### 언어 설정 API\n\n```jsp\nString lang = m.rs(\"lang\", \"default\");\n\n// 쿠키에 저장 (1년)\nm.setCookie(\"lang\", lang, 365);\n\n// 또는 세션에 저장\nsession.setAttribute(\"lang\", lang);\n```\n\n---\n\n## 모범 사례\n\n### 1. 메시지 키 네이밍\n\n계층적 구조 사용:\n```properties\nuser.profile.title=프로필\nuser.profile.edit=프로필 수정\nuser.settings.password=비밀번호 변경\n```\n\n### 2. 공통 메시지 재사용\n\n```properties\ncommon.save=저장\ncommon.cancel=취소\ncommon.delete=삭제\ncommon.confirm=확인\n```\n\n### 3. UTF-8 인코딩\n\n메시지 파일은 반드시 UTF-8로 저장합니다.\n\n### 4. 성능 최적화\n\nMessage 객체를 재사용하여 성능을 최적화합니다.\n\n---\n\n## 주의사항\n\n1. **파일 인코딩**: 메시지 파일은 반드시 UTF-8로 저장\n2. **키 일관성**: 모든 언어 파일에 동일한 키 사용\n3. **기본 언어**: `message.properties`는 항상 유지 (폴백용)\n4. **특수 문자**: `=`, `:`, `#` 등은 이스케이프 필요\n\n---\n\n## 관련 문서\n\n- [환경설정 및 캐시](configuration.md) - Config 클래스\n- [유틸리티 메소드](utility-methods.md) - 문자열 처리\n- [템플릿](template.md) - 템플릿에서 다국어 사용",
  "sections": [
    { "heading": "기본 개념", "content": "properties 파일 기반의 다국어 메시지 시스템으로 로케일 지원, 폴백 처리, 메모리 캐싱 기능을 제공합니다." },
    { "heading": "메시지 파일 구조", "content": "WEB-INF/message/ 경로의 파일 위치, 명명 규칙(message_en.properties 등), 키-값 형식입니다." },
    { "heading": "Message 클래스 사용", "content": "Message 객체 생성, 로케일 지정(setLocale), 기본값 처리 방법입니다." },
    { "heading": "동적 메시지", "content": "MessageFormat 스타일({0}, {1}) 매개변수와 플레이스홀더({{name}}) 치환 방법입니다." },
    { "heading": "배열과 Map 처리", "content": "getArray()와 getMap()을 사용한 배열/Map 메시지 처리 방법입니다." },
    { "heading": "캐시 및 성능", "content": "메모리 캐싱과 reload()/reloadAll()을 사용한 캐시 새로고침 방법입니다." },
    { "heading": "실제 사용 예제", "content": "다국어 웹페이지, 폼 검증 메시지, 동적 알림 메시지 예제입니다." },
    { "heading": "언어 전환 구현", "content": "쿠키/세션 기반 언어 설정과 언어 선택 UI 구현 방법입니다." },
    { "heading": "모범 사례", "content": "계층적 키 네이밍, 공통 메시지 재사용, UTF-8 인코딩, 성능 최적화 등의 모범 사례입니다." },
    { "heading": "주의사항", "content": "파일 인코딩, 키 일관성, 기본 언어 유지, 특수 문자 이스케이프 등의 주의사항입니다." }
  ],
  "related_docs": ["email", "calendar"],
  "related_classes": ["Malgn", "Form", "Page", "DataSet"]
}
