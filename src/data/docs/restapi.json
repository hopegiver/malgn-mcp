{
  "slug": "restapi",
  "title": "REST API 개발",
  "category": "web",
  "content": "# REST API 개발\n\n맑은프레임워크의 **RestAPI 클래스**를 사용하면 HTTP 메소드(GET, POST, PUT, DELETE, PATCH)별로 분기 처리하여 RESTful API를 쉽게 개발할 수 있습니다.\n\n---\n\n## URL 라우팅 설정\n\nREST API에서는 `/api/user`와 같이 확장자 없는 깔끔한 URL을 사용합니다. `/api/*` 경로를 `/api/index.jsp`로 매핑하고, index.jsp에서 라우팅을 처리합니다.\n\n### 1. web.xml 설정\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<web-app xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee\n         http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd\"\n         version=\"3.1\">\n\n    <!-- /api/* 요청을 /api/index.jsp로 매핑 -->\n    <servlet>\n        <servlet-name>APIRouter</servlet-name>\n        <jsp-file>/api/index.jsp</jsp-file>\n    </servlet>\n    <servlet-mapping>\n        <servlet-name>APIRouter</servlet-name>\n        <url-pattern>/api/*</url-pattern>\n    </servlet-mapping>\n\n</web-app>\n```\n\n### 2. /api/index.jsp 라우터 구현\n\n라우팅 그룹을 등록하고 요청을 해당 JSP로 포워딩합니다.\n\n```jsp\n<%@ page contentType=\"application/json; charset=utf-8\" %><%@ page import=\"java.util.*, malgnsoft.util.*\" %><%\n\nRestAPI router = new RestAPI(request, response);\n\n// CORS 설정 (모든 도메인 허용)\nrouter.cors();\n\n// OPTIONS 요청 (preflight) 처리\nif(router.handlePreflight()) return;\n\n// 라우팅 그룹 등록\nrouter.use(\"/api/user\", \"/api/user.jsp\");\nrouter.use(\"/api/product\", \"/api/product.jsp\");\nrouter.use(\"/api/admin/user\", \"/api/admin/user.jsp\");\nrouter.use(\"/api/admin/stats\", \"/api/admin/stats.jsp\");\n\n// 등록된 라우트로 자동 포워딩\nrouter.forward();\n\n%>\n```\n\n또는 `dispatch()` 사용 (동일한 기능):\n```jsp\nrouter.dispatch();\n```\n\n**여러 도메인 허용:**\n```jsp\n// 여러 도메인 허용 - String 배열\nrouter.cors(new String[]{\n    \"https://yourdomain.com\",\n    \"https://app.yourdomain.com\",\n    \"http://localhost:3000\"\n});\n```\n\n### 3. /api/init.jsp 공통 초기화 파일\n\nAPI 폴더의 모든 JSP 파일에서 공통으로 사용할 객체와 인증을 초기화합니다.\n\n```jsp\n<%@ page contentType=\"application/json; charset=utf-8\" %><%@ page import=\"java.util.*, java.io.*, dao.*, malgnsoft.db.*, malgnsoft.util.*\" %><%\n\nRestAPI api = new RestAPI(request, response);\n\n// CORS 설정 (외부 도메인 API 호출 허용)\napi.cors();  // 모든 도메인 허용\n\n// 또는 여러 도메인 허용 (화이트리스트)\n// api.cors(new String[]{\n//     \"https://yourdomain.com\",\n//     \"https://app.yourdomain.com\",\n//     \"http://localhost:3000\"\n// });\n\n// OPTIONS 요청 (preflight) 처리\nif(api.handlePreflight()) return;\n\n// 퍼블릭 라우팅 설정 (인증 불필요)\napi.publicRoute(\n    \"/api/auth/login\",\n    \"/api/auth/register\",\n    \"/api/public/*\"  // 와일드카드 사용 가능\n);\n\nMalgn m = new Malgn(request, response, out);\n\nForm f = new Form();\nf.setRequest(request);\n\nJson j = new Json(out);\n\n// JWT 토큰 인증 (퍼블릭 라우팅 자동 체크)\nif(!api.auth()) return;\n\n// 인증된 사용자 정보\nint userId = api.getDataInt(\"user_id\");\nString userName = api.getData(\"user_name\");\nint userLevel = api.getDataInt(\"user_level\");\n\n%>\n```\n\n### 4. 퍼블릭 라우팅 설정\n\n인증이 필요 없는 API 경로를 지정할 수 있습니다.\n\n**퍼블릭 라우팅 지정:**\n```jsp\n// init.jsp에서 설정\napi.publicRoute(\n    \"/api/auth/login\",      // 로그인 API\n    \"/api/auth/register\",   // 회원가입 API\n    \"/api/public/*\"         // /api/public 하위 모든 경로\n);\n```\n\n**와일드카드 패턴:**\n- `/api/auth/*` - `/api/auth` 하위 모든 경로\n- `/api/public/*` - `/api/public` 하위 모든 경로\n- 정확히 일치하는 경로는 와일드카드 없이 지정\n\n**인증 체크:**\n```jsp\n// init.jsp에서 자동 처리 - 매우 간단!\nif(!api.auth()) return;\n\n// 인증된 사용자 정보 자동 로드\nint userId = api.getDataInt(\"user_id\");\nString userName = api.getData(\"user_name\");\nint userLevel = api.getDataInt(\"user_level\");\n```\n\n**`api.auth()` 메소드 동작:**\n1. 퍼블릭 라우팅이면 인증 불필요 (true 반환)\n2. 퍼블릭이 아니면 JWT 토큰 검증\n3. 토큰이 없거나 유효하지 않으면 에러 응답 자동 출력 (false 반환)\n4. 토큰이 유효하면 사용자 정보 자동 로드 (true 반환)\n\n**장점:**\n- 퍼블릭 API는 인증 없이 접근 가능\n- 나머지 API는 자동으로 인증 체크\n- 각 API 파일에서 인증 코드 작성 불필요\n\n### 5. 디렉토리 구조\n\n```\nwebapp/\n├── api/\n│   ├── index.jsp          (라우터)\n│   ├── init.jsp           (공통 초기화)\n│   ├── user.jsp           → /api/user (인증 필요)\n│   ├── product.jsp        → /api/product (인증 필요)\n│   ├── auth/\n│   │   ├── login.jsp      → /api/auth/login (퍼블릭)\n│   │   └── register.jsp   → /api/auth/register (퍼블릭)\n│   ├── public/\n│   │   └── info.jsp       → /api/public/* (퍼블릭)\n│   └── admin/\n│       └── stats.jsp      → /api/admin/stats (인증 필요)\n└── WEB-INF/\n    └── web.xml\n```\n\n### 6. 동작 방식\n\n- `/api/user` → `index.jsp` → `/api/user.jsp` → `api.get(\"/\", ...)`\n- `/api/user/123` → `index.jsp` → `/api/user.jsp` → `api.get(\"/:id\", ...)` (path parameter)\n- `/api/user?keyword=홍길동` → `index.jsp` → `/api/user.jsp` → `api.get(\"/\", ...)` (query string)\n- `/api/admin/stats` → `index.jsp` → `/api/admin/stats.jsp`\n\n---\n\n## web.xml 없이 직접 호출 방식\n\nweb.xml 설정 없이 JSP 파일을 직접 호출하여 REST API를 구현할 수도 있습니다.\n\n### 언제 사용하나?\n\n- **빠른 프로토타이핑**: web.xml 설정이 번거로울 때\n- **간단한 API**: 복잡한 라우팅이 필요 없을 때\n- **레거시 프로젝트**: web.xml을 수정할 수 없을 때\n\n### 장단점\n\n**장점:**\n- web.xml 설정 불필요\n- 간단한 구조\n- 즉시 사용 가능\n\n**단점:**\n- URL에 `.jsp` 확장자 노출\n- Path parameter 사용 가능하지만 권장하지 않음 (Query String 권장)\n- RESTful 스타일 아님\n\n### 사용 예시\n\n#### /api/user.jsp (직접 호출)\n\n```jsp\n<%@ include file=\"/api/init.jsp\" %><%\n\n// GET /api/user.jsp - 목록 조회\napi.get(\"/\", () -> {\n    UserDao user = new UserDao();\n    DataSet list = user.find();\n    j.success(\"조회되었습니다.\", list);\n});\n\n// POST /api/user.jsp - 생성\napi.post(\"/\", () -> {\n    UserDao user = new UserDao();\n    user.item(\"name\", f.get(\"name\"));\n    user.item(\"email\", f.get(\"email\"));\n\n    if(user.insert()) {\n        j.success(\"등록되었습니다.\", user.id);\n    } else {\n        j.error(\"DATABASE_ERROR\", user.getErrMsg());\n    }\n});\n\n// PUT /api/user.jsp - 수정 (ID는 query string으로 전달)\napi.put(\"/\", () -> {\n    int id = m.ri(\"id\");  // query string에서 id 추출\n\n    UserDao user = new UserDao();\n    user.get(id);\n    user.item(\"name\", f.get(\"name\"));\n    user.item(\"email\", f.get(\"email\"));\n\n    if(user.update()) {\n        j.success(\"수정되었습니다.\");\n    } else {\n        j.error(\"DATABASE_ERROR\", user.getErrMsg());\n    }\n});\n\n// DELETE /api/user.jsp - 삭제 (ID는 query string으로 전달)\napi.delete(\"/\", () -> {\n    int id = m.ri(\"id\");  // query string에서 id 추출\n\n    UserDao user = new UserDao();\n    if(user.delete(id)) {\n        j.success(\"삭제되었습니다.\");\n    } else {\n        j.error(\"DATABASE_ERROR\", user.getErrMsg());\n    }\n});\n\n%>\n```\n\n**주의:**\n- `init.jsp`를 include하면 CORS, OPTIONS, 인증 처리가 자동으로 적용됩니다\n- `api`, `m`, `f`, `j` 객체가 자동으로 생성됩니다\n- JWT 인증이 필요하면 `init.jsp`에서 `api.publicRoute()`로 퍼블릭 경로를 지정하세요\n\n### 클라이언트 호출\n\n```javascript\n// GET /api/user.jsp - 목록 조회\nfetch('/api/user.jsp')\n    .then(response => response.json())\n    .then(data => console.log(data));\n\n// POST /api/user.jsp - 생성\nfetch('/api/user.jsp', {\n    method: 'POST',\n    headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n    },\n    body: 'name=홍길동&email=hong@example.com'\n})\n    .then(response => response.json())\n    .then(data => console.log(data));\n\n// PUT /api/user.jsp?id=123 - 수정 (query string으로 ID 전달)\nfetch('/api/user.jsp?id=123', {\n    method: 'PUT',\n    headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n    },\n    body: 'name=김철수&email=kim@example.com'\n})\n    .then(response => response.json())\n    .then(data => console.log(data));\n\n// DELETE /api/user.jsp?id=123 - 삭제 (query string으로 ID 전달)\nfetch('/api/user.jsp?id=123', {\n    method: 'DELETE'\n})\n    .then(response => response.json())\n    .then(data => console.log(data));\n```\n\n### 주의사항\n\n1. **Path Parameter는 Query String 사용 권장**\n   - Path parameter 사용 가능: `/api/user.jsp/123`\n   - Query string 권장: `/api/user.jsp?id=123`\n   - **이유:** JSP 직접 호출 시 Path parameter는 서버 설정에 따라 작동하지 않을 수 있습니다\n\n2. **모든 HTTP 메소드 지원**\n   - GET, POST, PUT, DELETE, PATCH 모두 사용 가능\n\n3. **init.jsp include 권장**\n   - `init.jsp`를 include하면 CORS, OPTIONS, JWT 인증이 자동으로 처리됩니다\n   - `api`, `m`, `f`, `j` 객체가 자동으로 생성되어 편리합니다\n   - 각 파일마다 객체 생성 코드를 작성할 필요가 없습니다\n\n4. **인증이 필요 없는 경우**\n   - 퍼블릭 API는 `init.jsp`에서 `api.publicRoute()`로 지정\n   - 또는 `init.jsp`의 `api.auth()` 부분을 주석 처리\n\n**권장사항:**\n- 프로덕션 환경에서는 **web.xml 라우팅 방식**을 권장합니다\n- web.xml 없이 직접 호출 시 **Query String** 방식을 권장합니다\n\n---\n\n## 기본 사용법\n\n### /api/user.jsp 예시 (라우팅 그룹 방식)\n\n```jsp\n<%@ include file=\"/api/init.jsp\" %><%\n\n// 이 파일의 base path 설정 (선택사항 - 생략하면 자동으로 /api/user 사용)\napi.setBasePath(\"/api/user\");\n\n// GET /api/user - 목록 조회\napi.get(\"/\", () -> {\n    UserDao user = new UserDao();\n    DataSet list = user.find();\n    j.put(\"users\", list);\n    j.success();\n});\n\n// GET /api/user/list - 페이징 목록 (고정 경로)\napi.get(\"/list\", () -> {\n    int page = m.ri(\"page\", 1);\n    int size = m.ri(\"size\", 20);\n\n    UserDao user = new UserDao();\n    DataSet list = user.findWithPaging(page, size);\n    int total = user.getTotal();\n\n    j.put(\"users\", list);\n    j.put(\"total\", total);\n    j.put(\"page\", page);\n    j.put(\"size\", size);\n    j.success();\n});\n\n// GET /api/user/active - 활성 사용자만 (고정 경로)\napi.get(\"/active\", () -> {\n    UserDao user = new UserDao();\n    DataSet list = user.findByStatus(\"active\");\n    j.put(\"users\", list);\n    j.success();\n});\n\n// GET /api/user/:id - 단일 조회 (path parameter)\napi.get(\"/:id\", () -> {\n    int id = api.paramInt(\"id\");  // path parameter에서 id 추출\n\n    UserDao user = new UserDao();\n    DataSet info = user.get(id);\n\n    if(info.next()) {\n        j.success(info);\n    } else {\n        j.error(\"NOT_FOUND\", \"사용자를 찾을 수 없습니다.\");\n    }\n});\n\n// POST /api/user - 생성\napi.post(\"/\", () -> {\n    UserDao user = new UserDao();\n    user.item(\"name\", f.get(\"name\"));\n    user.item(\"email\", f.get(\"email\"));\n\n    if(user.insert()) {\n        j.put(\"id\", user.id);\n        j.success(\"등록되었습니다.\");\n    } else {\n        j.error(\"DATABASE_ERROR\", user.getErrMsg());\n    }\n});\n\n// PUT /api/user/:id - 수정 (path parameter)\napi.put(\"/:id\", () -> {\n    int id = api.paramInt(\"id\");\n\n    UserDao user = new UserDao();\n    user.get(id);\n    user.item(\"name\", f.get(\"name\"));\n    user.item(\"email\", f.get(\"email\"));\n\n    if(user.update()) {\n        j.success(\"수정되었습니다.\");\n    } else {\n        j.error(\"DATABASE_ERROR\", user.getErrMsg());\n    }\n});\n\n// PATCH /api/user/:id - 부분 수정 (path parameter)\napi.patch(\"/:id\", () -> {\n    int id = api.paramInt(\"id\");\n\n    UserDao user = new UserDao();\n    user.get(id);\n\n    // 전달된 필드만 업데이트\n    String name = f.get(\"name\");\n    if(!\"\".equals(name)) user.item(\"name\", name);\n\n    String email = f.get(\"email\");\n    if(!\"\".equals(email)) user.item(\"email\", email);\n\n    if(user.update()) {\n        j.success(\"수정되었습니다.\");\n    } else {\n        j.error(\"DATABASE_ERROR\", user.getErrMsg());\n    }\n});\n\n// DELETE /api/user/:id - 삭제 (path parameter)\napi.delete(\"/:id\", () -> {\n    int id = api.paramInt(\"id\");\n\n    UserDao user = new UserDao();\n    if(user.delete(id)) {\n        j.success(\"삭제되었습니다.\");\n    } else {\n        j.error(\"DATABASE_ERROR\", user.getErrMsg());\n    }\n});\n\n%>\n```\n\n**Base Path 자동 설정:**\n- `RestAPI` 객체 생성 시 현재 JSP 파일 경로에서 자동 설정됩니다\n- 예: `/api/user.jsp` → basePath는 `/api/user`\n- 예: `/api/admin/stats.jsp` → basePath는 `/api/admin/stats`\n- 다르게 사용하고 싶으면 `api.setBasePath(\"/api/user\")` 호출\n\n**장점:**\n- **라우팅 그룹**: `/api/user` 관련 모든 경로를 user.jsp에서 처리\n- **Path parameter 지원**: `/:id` 패턴으로 RESTful URL 구현 가능\n- **Express.js 스타일**: 익숙한 라우팅 패턴\n- **계층적 구조**: 리소스별로 파일 분리, 관리 용이\n- **자동 base path**: 파일 경로에서 자동 설정되어 편리\n- 각 API 파일은 비즈니스 로직만 작성\n\n---\n\n## 인증 처리\n\n`/api/init.jsp`에서 기본적인 인증 체크를 수행하지만, 각 API에서 추가 인증이 필요한 경우 처리할 수 있습니다.\n\n### /api/admin/user.jsp 예시 (관리자 전용 API)\n\n```jsp\n<%@ include file=\"/api/init.jsp\" %><%\n\n// 로그인 체크\nif(userId == 0) {\n    api.error(401, \"로그인이 필요합니다.\");\n    return;\n}\n\n// 관리자 권한 체크\nif(userLevel < 10) {\n    api.error(403, \"관리자만 접근할 수 있습니다.\");\n    return;\n}\n\n// GET /api/admin/user - 사용자 목록 조회\napi.get(\"/\", () -> {\n    UserDao user = new UserDao();\n    DataSet list = user.find();\n    j.put(\"users\", list);\n    j.success();\n});\n\n// GET /api/admin/user/:id - 특정 사용자 조회\napi.get(\"/:id\", () -> {\n    int id = api.paramInt(\"id\");\n\n    UserDao user = new UserDao();\n    DataSet info = user.get(id);\n\n    if(info.next()) {\n        j.success(info);\n    } else {\n        j.error(\"NOT_FOUND\", \"사용자를 찾을 수 없습니다.\");\n    }\n});\n\n// POST /api/admin/user - 사용자 생성\napi.post(\"/\", () -> {\n    UserDao user = new UserDao();\n    user.item(\"name\", f.get(\"name\"));\n    user.item(\"email\", f.get(\"email\"));\n    user.item(\"created_by\", userId);  // init.jsp에서 설정된 userId 사용\n\n    if(user.insert()) {\n        j.put(\"id\", user.id);\n        j.success(\"등록되었습니다.\");\n    } else {\n        j.error(\"DATABASE_ERROR\", user.getErrMsg());\n    }\n});\n\n// PUT /api/admin/user/:id - 사용자 수정\napi.put(\"/:id\", () -> {\n    int id = api.paramInt(\"id\");\n\n    UserDao user = new UserDao();\n    user.get(id);\n    user.item(\"name\", f.get(\"name\"));\n    user.item(\"email\", f.get(\"email\"));\n\n    if(user.update()) {\n        j.success(\"수정되었습니다.\");\n    } else {\n        j.error(\"DATABASE_ERROR\", user.getErrMsg());\n    }\n});\n\n// DELETE /api/admin/user/:id - 사용자 삭제\napi.delete(\"/:id\", () -> {\n    int id = api.paramInt(\"id\");\n\n    UserDao user = new UserDao();\n    if(user.delete(id)) {\n        j.success(\"삭제되었습니다.\");\n    } else {\n        j.error(\"DATABASE_ERROR\", user.getErrMsg());\n    }\n});\n\n%>\n```\n\n**장점:**\n- `init.jsp`에서 기본 인증 처리 (userId, userName 설정)\n- 각 API에서 필요한 추가 권한 체크만 수행\n- 로그인 사용자 정보 자동 설정\n\n---\n\n## 에러 처리\n\n### 1. 인증 실패 (401 Unauthorized)\n\n```jsp\nif(userId == 0) {\n    api.error(401, \"인증실패\");\n    return;  // 필수!\n}\n```\n\n### 2. 권한 없음 (403 Forbidden)\n\n```jsp\nif(userLevel < 10) {\n    api.error(403, \"관리자만 접근할 수 있습니다.\");\n    return;\n}\n```\n\n### 3. 잘못된 요청 (400 Bad Request)\n\n```jsp\napi.post(\"/\", () -> {\n    String name = f.get(\"name\");\n    if(\"\".equals(name)) {\n        api.error(400, \"이름은 필수입니다.\");\n        return;\n    }\n\n    // 정상 처리\n    j.success(\"처리되었습니다.\");\n});\n```\n\n### 4. 지원하는 에러 코드\n\n- **401**: Unauthorized (인증 실패)\n- **403**: Forbidden (권한 없음)\n- **400**: Bad Request (잘못된 요청)\n\n---\n\n## 클라이언트 호출 예시\n\n### JavaScript (fetch API)\n\n```javascript\n// GET /api/user - 목록 조회\nfetch('/api/user')\n    .then(response => response.json())\n    .then(data => console.log(data));\n\n// GET /api/user/list - 페이징 목록 (고정 경로)\nfetch('/api/user/list?page=1&size=20')\n    .then(response => response.json())\n    .then(data => console.log(data));\n\n// GET /api/user/active - 활성 사용자 (고정 경로)\nfetch('/api/user/active')\n    .then(response => response.json())\n    .then(data => console.log(data));\n\n// GET /api/user/123 - 단일 조회 (path parameter)\nfetch('/api/user/123')\n    .then(response => response.json())\n    .then(data => console.log(data));\n\n// GET /api/user?keyword=홍길동 - 검색 (query string)\nfetch('/api/user?keyword=홍길동')\n    .then(response => response.json())\n    .then(data => console.log(data));\n\n// POST /api/user - 생성\nfetch('/api/user', {\n    method: 'POST',\n    headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n    },\n    body: 'name=홍길동&email=hong@example.com'\n})\n    .then(response => response.json())\n    .then(data => console.log(data));\n\n// PUT /api/user/123 - 전체 수정 (path parameter)\nfetch('/api/user/123', {\n    method: 'PUT',\n    headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n    },\n    body: 'name=김철수&email=kim@example.com'\n})\n    .then(response => response.json())\n    .then(data => console.log(data));\n\n// PATCH /api/user/123 - 부분 수정 (path parameter)\nfetch('/api/user/123', {\n    method: 'PATCH',\n    headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n    },\n    body: 'name=김철수'  // 이름만 수정\n})\n    .then(response => response.json())\n    .then(data => console.log(data));\n\n// DELETE /api/user/123 - 삭제 (path parameter)\nfetch('/api/user/123', {\n    method: 'DELETE'\n})\n    .then(response => response.json())\n    .then(data => console.log(data));\n```\n\n---\n\n## 사용 시 주의사항\n\n### 1. Content-Type 설정\n\nREST API 파일은 반드시 `application/json`으로 설정하세요:\n\n```jsp\n<%@ page contentType=\"application/json; charset=utf-8\" %>\n```\n\n### 2. return 키워드 사용\n\n에러 처리 후에는 반드시 `return`을 사용하세요:\n\n```jsp\nif(userId == 0) {\n    api.error(401, \"인증실패\");\n    return;  // 필수!\n}\n```\n\n### 3. Lambda 표현식\n\nJava 8 이상에서만 사용 가능합니다. Lambda 표현식 `() -> { }` 사용.\n\n### 4. 예외 처리\n\nRestAPI 클래스는 내부적으로 예외를 처리하므로 try-catch가 필요 없습니다.\n\n### 5. 파라미터 전달\n\n**Path parameter (권장):**\n```jsp\n// /:id 패턴\napi.get(\"/:id\", () -> {\n    int id = api.paramInt(\"id\");  // /api/user/123 → id=123\n    // ...\n});\n\n// 복수 parameter\napi.get(\"/:category/:id\", () -> {\n    String category = api.param(\"category\");  // /api/product/food/123\n    int id = api.paramInt(\"id\");\n    // ...\n});\n```\n\n**Query string (검색, 필터링):**\n```jsp\napi.get(\"/\", () -> {\n    String keyword = m.rs(\"keyword\");  // /api/user?keyword=홍길동\n    int page = m.ri(\"page\");           // /api/user?page=2\n    // ...\n});\n```\n\n### 6. GET 파라미터 보안 (선택사항)\n\nAPI에서도 GET 파라미터에 XSS 필터를 적용하려면 `m.rs()`/`m.ri()` 사용을 권장:\n\n```jsp\napi.get(\"/\", () -> {\n    String keyword = m.rs(\"keyword\");  // XSS 필터 적용\n    int page = m.ri(\"page\");           // XSS 필터 적용\n\n    UserDao user = new UserDao();\n    DataSet list = user.search(keyword, page);\n    j.put(\"users\", list);\n    j.success();\n});\n```\n\n---\n\n## 고급 라우팅\n\n복잡한 Path Parameter 패턴과 RESTful 라우팅이 필요하다면 [고급 라우팅 가이드](restapi-advanced.md)를 참고하세요.\n\n**주요 내용:**\n- 고정 경로와 Path Parameter 혼합 사용\n- 복수 Parameter 패턴 (`/:category/:id`)\n- 매칭 우선순위\n- Query String과 함께 사용\n- 중첩 리소스 라우팅 (예: `/api/post/:id/comments`)\n\n---\n\n## 추가 기능\n\n### JWT 인증\n\nJWT(JSON Web Token) 기반 인증을 지원합니다. 자세한 내용은 [JWT 인증 가이드](restapi-jwt.md)를 참고하세요.\n\n**주요 기능:**\n- JWT 토큰 생성 및 검증\n- 퍼블릭 라우팅 (인증 불필요 경로)\n- 자동 사용자 정보 로드\n- Bearer 토큰 자동 추출\n\n### CORS 설정\n\n외부 도메인에서 API 호출 시 필요한 CORS 헤더 설정을 지원합니다. 자세한 내용은 [CORS 설정 가이드](restapi-cors.md)를 참고하세요.\n\n**주요 기능:**\n- 모든 도메인 또는 특정 도메인만 허용\n- 여러 도메인 화이트리스트\n- OPTIONS Preflight 자동 처리\n- Credentials 지원\n\n### 응답 표준\n\n일관된 JSON 응답 형식을 제공합니다. 자세한 내용은 [응답 표준 가이드](restapi-response.md)를 참고하세요.\n\n**주요 기능:**\n- 표준 에러 응답 (`success`, `error`, `message`, `details`)\n- 표준 성공 응답 (`success`, `message`, `data`)\n- 페이징 응답 표준\n- HTTP 상태 코드 설정\n\n---\n\n## 관련 문서\n\n- **[고급 라우팅](restapi-advanced.md)** - Path Parameter 상세, RESTful 패턴\n- **[JWT 인증](restapi-jwt.md)** - JWT 토큰 생성, 검증, 퍼블릭 라우팅\n- **[CORS 설정](restapi-cors.md)** - CORS 헤더 설정, 도메인 허용\n- **[응답 표준](restapi-response.md)** - 에러/성공 응답, 페이징\n- **[JSON 처리](json.md)** - Json 클래스 상세 가이드\n- **[인증 처리](authentication.md)** - Auth 클래스 활용 (세션 기반)\n\n---\n\n[← 목차로 돌아가기](README.md)",
  "sections": [
    {
      "heading": "URL 라우팅 설정",
      "content": "REST API에서는 `/api/user`와 같이 확장자 없는 깔끔한 URL을 사용합니다. `/api/*` 경로를 `/api/index.jsp`로 매핑하고, index.jsp에서 라우팅을 처리합니다. web.xml 설정, 라우터 구현, 공통 초기화 파일, 퍼블릭 라우팅 설정, 디렉토리 구조, 동작 방식을 포함합니다."
    },
    {
      "heading": "web.xml 없이 직접 호출 방식",
      "content": "web.xml 설정 없이 JSP 파일을 직접 호출하여 REST API를 구현할 수 있습니다. 빠른 프로토타이핑, 간단한 API, 레거시 프로젝트에 적합합니다."
    },
    {
      "heading": "기본 사용법",
      "content": "/api/user.jsp 예시로 라우팅 그룹 방식의 GET, POST, PUT, PATCH, DELETE 메소드 구현을 보여줍니다. Base Path 자동 설정 및 Express.js 스타일 라우팅 패턴을 사용합니다."
    },
    {
      "heading": "인증 처리",
      "content": "`/api/init.jsp`에서 기본적인 인증 체크를 수행하지만, 각 API에서 추가 인증이 필요한 경우 처리할 수 있습니다. 관리자 전용 API 예시를 포함합니다."
    },
    {
      "heading": "에러 처리",
      "content": "인증 실패(401), 권한 없음(403), 잘못된 요청(400) 등의 에러 처리 방법을 다룹니다."
    },
    {
      "heading": "클라이언트 호출 예시",
      "content": "JavaScript fetch API를 사용한 GET, POST, PUT, PATCH, DELETE 호출 예시를 제공합니다."
    },
    {
      "heading": "사용 시 주의사항",
      "content": "Content-Type 설정, return 키워드 사용, Lambda 표현식, 예외 처리, 파라미터 전달, GET 파라미터 보안에 대한 주의사항입니다."
    },
    {
      "heading": "고급 라우팅",
      "content": "복잡한 Path Parameter 패턴과 RESTful 라우팅을 위한 고급 가이드 링크를 제공합니다."
    },
    {
      "heading": "추가 기능",
      "content": "JWT 인증, CORS 설정, 응답 표준 등 추가 기능에 대한 개요와 관련 문서 링크를 제공합니다."
    },
    {
      "heading": "관련 문서",
      "content": "고급 라우팅, JWT 인증, CORS 설정, 응답 표준, JSON 처리, 인증 처리 등 관련 문서 목록입니다."
    }
  ],
  "related_docs": ["restapi-advanced", "restapi-jwt", "restapi-cors", "restapi-response", "authentication", "http-client"],
  "related_classes": ["RestAPI", "Malgn", "Form", "Json", "DataSet"]
}
